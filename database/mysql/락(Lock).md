# 락(Lock)

---

### 락(Lock)이란?
- 여러 트랜잭션에서 동시에 데이터베이스의 특정 리소스를 조회, 수정, 등록, 삭제할 수 있는데 이로 인해 발생할 수 있는 동시성 문제를
막고자 도입된 개념
- 락을 획득하면 다른 사용자는 락을 획득할 때까지 해당 리소스에 접근(조회, 수정, 등록, 삭제)할 수 없다.
- 락을 해제하면 다른 트랜잭션이 해당 리소스를 사용할 수 있게 된다.

---


### MySQL 엔진의 잠금
- 글로벌 락
- 테이블 락 : 개별 테이블 단위로 설정되는 잠금
- 네임드 락 : 임의 문자열에 대해 설정되는 잠금
  - `GET_LOCK(...)` 함수를 이용하여, 특정 문자열에 대해 일정 기간동안 잠금을 획득할 수 있음.
  - `RELEASE_LOCK(...)` : 네임드 락을 다시 반납
- 메타데이터 락

---

### InnoDB 스토리지 엔진의 잠금
- 레코드 락 : 행 잠금
  - InnoDB 스토리지 엔진은 레코드 자체가 아니라, 인덱스의 레코드를 잠근다.
  - 종류
    - Shared Lock
    - Exclusive Lock
- 갭 락 : 특정 범위 내에서, 레코드와 레코드 사이의 사이에 새로운 데이터의 삽입(INSERT)을 금지하는 락
- 넥스트 키 락
  - 레코드 락 + 갭 락
  - 특정 범위 내에서, 레코드 뿐만 아니라 레코드 사이의 Gap 에 대해 거는 락
  - Repeatable Read 격리 수준을 사용해야 함.
- 자동 증가 락

---
